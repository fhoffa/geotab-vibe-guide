{
  "name": "Ace vs API Comparison",
  "supportEmail": "https://github.com/fhoffa/geotab-vibe-guide",
  "version": "1.1",
  "items": [{
    "url": "page.html",
    "path": "ActivityLink",
    "menuName": { "en": "Ace vs API Comparison" }
  }],
  "files": {
    "page.html": "<!DOCTYPE html><html><head><meta charset='utf-8'><title>Ace vs API Comparison</title></head><body style='padding:20px;font-family:system-ui,-apple-system,sans-serif;background:#f8fafc;color:#1e293b;max-width:1400px;margin:0 auto;'><h1 style='color:#0f172a;margin-bottom:4px;'>Ace vs Direct API Comparison</h1><p style='color:#64748b;margin-top:0;margin-bottom:24px;'>Three tests demonstrating when to use each approach</p><div style='display:grid;grid-template-columns:repeat(3,1fr);gap:16px;'><div style='background:#fff;padding:16px;border-radius:10px;border:1px solid #e2e8f0;box-shadow:0 1px 3px rgba(0,0,0,0.1);'><div style='display:flex;align-items:center;gap:8px;margin-bottom:12px;border-bottom:1px solid #f1f5f9;padding-bottom:12px;'><span style='font-size:20px;'>1️⃣</span><div><h3 style='margin:0;font-size:14px;color:#0f172a;'>Speed Test</h3><p style='margin:0;font-size:11px;color:#64748b;'>Same question, timing comparison</p></div></div><div style='display:grid;grid-template-columns:1fr 1fr;gap:8px;'><div style='background:#f0fdf4;padding:10px;border-radius:6px;border:1px solid #bbf7d0;'><div style='font-size:10px;color:#166534;font-weight:600;margin-bottom:4px;'>DIRECT API</div><div id='t1-api-time' style='font-size:18px;font-weight:bold;color:#15803d;'>--</div><div id='t1-api-status' style='font-size:10px;color:#166534;'>Waiting...</div></div><div style='background:#fefce8;padding:10px;border-radius:6px;border:1px solid #fef08a;'><div style='font-size:10px;color:#a16207;font-weight:600;margin-bottom:4px;'>ACE AI</div><div id='t1-ace-time' style='font-size:18px;font-weight:bold;color:#ca8a04;'>--</div><div id='t1-ace-status' style='font-size:10px;color:#a16207;'>Waiting...</div></div></div><div style='margin-top:10px;font-size:11px;color:#64748b;'>Q: \"How many vehicles?\"</div></div><div style='background:#fff;padding:16px;border-radius:10px;border:1px solid #e2e8f0;box-shadow:0 1px 3px rgba(0,0,0,0.1);'><div style='display:flex;align-items:center;gap:8px;margin-bottom:12px;border-bottom:1px solid #f1f5f9;padding-bottom:12px;'><span style='font-size:20px;'>2️⃣</span><div><h3 style='margin:0;font-size:14px;color:#0f172a;'>Freshness Test</h3><p style='margin:0;font-size:11px;color:#64748b;'>Ace data can be hours behind</p></div></div><div style='display:grid;grid-template-columns:1fr 1fr;gap:8px;'><div style='background:#f0fdf4;padding:10px;border-radius:6px;border:1px solid #bbf7d0;'><div style='font-size:10px;color:#166534;font-weight:600;margin-bottom:4px;'>API (Real-time)</div><div id='t2-api-result' style='font-size:11px;color:#15803d;word-break:break-word;'>Waiting...</div></div><div style='background:#fefce8;padding:10px;border-radius:6px;border:1px solid #fef08a;'><div style='font-size:10px;color:#a16207;font-weight:600;margin-bottom:4px;'>ACE (Historical)</div><div id='t2-ace-result' style='font-size:11px;color:#ca8a04;word-break:break-word;'>Waiting...</div></div></div><div style='margin-top:10px;font-size:11px;color:#64748b;'>Compares most recent trip timestamp</div></div><div style='background:#fff;padding:16px;border-radius:10px;border:1px solid #e2e8f0;box-shadow:0 1px 3px rgba(0,0,0,0.1);'><div style='display:flex;align-items:center;gap:8px;margin-bottom:12px;border-bottom:1px solid #f1f5f9;padding-bottom:12px;'><span style='font-size:20px;'>3️⃣</span><div><h3 style='margin:0;font-size:14px;color:#0f172a;'>Complex Analysis</h3><p style='margin:0;font-size:11px;color:#64748b;'>What only Ace can do</p></div></div><div style='background:#fefce8;padding:10px;border-radius:6px;border:1px solid #fef08a;'><div style='font-size:10px;color:#a16207;font-weight:600;margin-bottom:4px;'>ACE ANALYSIS</div><div id='t3-ace-status' style='font-size:11px;color:#a16207;'>Waiting...</div><pre id='t3-ace-result' style='font-size:10px;margin:8px 0 0 0;background:#fffbeb;padding:8px;border-radius:4px;overflow:auto;max-height:120px;white-space:pre-wrap;'></pre></div><div style='margin-top:10px;font-size:11px;color:#64748b;'>Q: \"Top 3 vehicles by distance this month\"</div></div></div><div style='margin-top:20px;background:#fff;padding:16px;border-radius:10px;border:1px solid #e2e8f0;'><h3 style='margin:0 0 12px 0;font-size:14px;color:#0f172a;'>Activity Log</h3><div id='log' style='background:#f8fafc;padding:10px;border-radius:6px;max-height:120px;overflow:auto;font-size:10px;font-family:ui-monospace,monospace;color:#475569;'></div></div><div style='margin-top:16px;background:#eff6ff;padding:16px;border-radius:10px;border:1px solid #bfdbfe;'><h3 style='margin:0 0 10px 0;font-size:14px;color:#1e40af;'>Key Takeaways</h3><div style='display:grid;grid-template-columns:repeat(3,1fr);gap:12px;font-size:12px;'><div><strong style='color:#15803d;'>Direct API</strong><ul style='margin:4px 0 0 0;padding-left:16px;color:#475569;'><li>~300-500ms response</li><li>Real-time data</li><li>Simple queries only</li></ul></div><div><strong style='color:#ca8a04;'>Ace AI</strong><ul style='margin:4px 0 0 0;padding-left:16px;color:#475569;'><li>~30-90 sec response</li><li>2-24 hours behind</li><li>Complex analysis</li></ul></div><div><strong style='color:#1e40af;'>When to Use</strong><ul style='margin:4px 0 0 0;padding-left:16px;color:#475569;'><li>API: live data, writes</li><li>Ace: trends, insights</li><li>Often: combine both!</li></ul></div></div></div><script>function log(m){var d=document.getElementById('log');var t=new Date().toLocaleTimeString();d.innerHTML='<div>['+t+'] '+m+'</div>'+d.innerHTML;}function getAceData(r){if(r&&r.apiResult&&r.apiResult.results)return r.apiResult.results[0]||{};return r||{};}geotab.addin['ace-api-comparison']=function(){return{initialize:function(api,state,callback){log('Starting 3 comparison tests...');runTest1(api);runTest2(api);runTest3(api);callback();},focus:function(){},blur:function(){}};};function runTest1(api){var apiStart=Date.now();document.getElementById('t1-api-status').textContent='Fetching...';api.call('Get',{typeName:'Device'},function(devices){var t=Date.now()-apiStart;document.getElementById('t1-api-time').textContent=t+'ms';document.getElementById('t1-api-status').textContent=devices.length+' vehicles';log('Test1 API: '+devices.length+' devices in '+t+'ms');},function(e){document.getElementById('t1-api-status').textContent='Error';});var aceStart=Date.now();document.getElementById('t1-ace-status').textContent='Processing...';aceQuery(api,'How many vehicles are in my fleet?',function(result){var t=Date.now()-aceStart;document.getElementById('t1-ace-time').textContent=Math.round(t/1000)+'s';var count='--';if(result.data&&result.data[0]){var keys=Object.keys(result.data[0]);count=result.data[0][keys[0]]||result.data.length;}document.getElementById('t1-ace-status').textContent=count+' vehicles';log('Test1 Ace: completed in '+Math.round(t/1000)+'s');},function(e){document.getElementById('t1-ace-status').textContent='Error';});}function runTest2(api){document.getElementById('t2-api-result').textContent='Fetching...';var now=new Date();var weekAgo=new Date(now.getTime()-7*24*60*60*1000);api.call('Get',{typeName:'Trip',search:{fromDate:weekAgo.toISOString(),toDate:now.toISOString()},resultsLimit:1},function(trips){if(trips&&trips.length>0){var t=trips[0];var stopTime=new Date(t.stop);var ago=Math.round((now-stopTime)/(1000*60));var agoStr=ago<60?ago+'m ago':Math.round(ago/60)+'h ago';document.getElementById('t2-api-result').innerHTML='<strong>'+agoStr+'</strong><br>'+stopTime.toLocaleString();}else{document.getElementById('t2-api-result').textContent='No recent trips';}log('Test2 API: Got most recent trip');},function(e){document.getElementById('t2-api-result').textContent='Error';});document.getElementById('t2-ace-result').textContent='Processing...';aceQuery(api,'When was the most recent trip? Give me the exact end time.',function(result){var aceText='--';if(result.reasoning){aceText=result.reasoning.substring(0,100)+'...';}if(result.data&&result.data[0]){aceText=JSON.stringify(result.data[0]);}document.getElementById('t2-ace-result').innerHTML=aceText;log('Test2 Ace: Got historical trip data');},function(e){document.getElementById('t2-ace-result').textContent='Error';});}function runTest3(api){document.getElementById('t3-ace-status').textContent='Processing (this takes ~60s)...';aceQuery(api,'What are the top 3 vehicles by total distance traveled this month? Show vehicle name and distance.',function(result){document.getElementById('t3-ace-status').textContent='Complete';var output='';if(result.data){output='DATA:\\n'+JSON.stringify(result.data,null,2);}if(result.reasoning){output+='\\n\\nREASONING:\\n'+result.reasoning.substring(0,300)+'...';}document.getElementById('t3-ace-result').textContent=output||'No data returned';log('Test3 Ace: Complex analysis complete');},function(e){document.getElementById('t3-ace-status').textContent='Error';});}function aceQuery(api,question,onSuccess,onError){api.call('GetAceResults',{serviceName:'dna-planet-orchestration',functionName:'create-chat',functionParameters:{}},function(r){var d=getAceData(r);var chatId=d.chat_id;if(!chatId){onError('No chat_id');return;}api.call('GetAceResults',{serviceName:'dna-planet-orchestration',functionName:'send-prompt',functionParameters:{chat_id:chatId,prompt:question}},function(r2){var d2=getAceData(r2);var mgId=d2.message_group_id||((d2.message_group||{}).id);if(!mgId){onError('No message_group_id');return;}setTimeout(function(){pollAce(api,chatId,mgId,onSuccess,onError,0);},10000);},onError);},onError);}function pollAce(api,chatId,mgId,onSuccess,onError,attempt){if(attempt>15){onError('Timeout');return;}api.call('GetAceResults',{serviceName:'dna-planet-orchestration',functionName:'get-message-group',functionParameters:{chat_id:chatId,message_group_id:mgId}},function(r){var d=getAceData(r);var mg=d.message_group||{};var st=mg.status?mg.status.status:'UNKNOWN';if(st==='DONE'){var msgs=mg.messages||{};var result={data:null,reasoning:null};Object.keys(msgs).forEach(function(k){var m=msgs[k];if(m.preview_array)result.data=m.preview_array;if(m.reasoning)result.reasoning=m.reasoning;});onSuccess(result);}else if(st==='FAILED'){onError('Query failed');}else{setTimeout(function(){pollAce(api,chatId,mgId,onSuccess,onError,attempt+1);},8000);}},function(){setTimeout(function(){pollAce(api,chatId,mgId,onSuccess,onError,attempt+1);},8000);});}console.log('Ace vs API Comparison v1.1 registered');</script></body></html>"
  }
}
